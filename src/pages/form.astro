---
import MainLayout from "../layouts/MainLayout.astro";
import Heading from "../components/Heading.astro";
import Text from "../components/Text.astro";
import Button from "../components/Button.astro";
---

<MainLayout title="Kontakt os">
  <section
    class="px-[var(--margin-section_left)] py-[var(--margin-section_top)] bg-[var(--color-white)]"
  >
    <div class="max-w-4xl mx-auto">
      <Heading
        htmlheading="h1"
        size="large"
        weight="bold"
        font="display"
        stylingclasses="text-[var(--color-green--400)] mb-6"
      >
        Kom i kontakt med os
      </Heading>

      <Text size="large" stylingclasses="mb-12 text-[var(--color-black)]">
        Udfyld formularen nedenfor, så vender vi tilbage til dig hurtigst
        muligt.
      </Text>

      <form
        x-data="{
          name: '',
          phone: '',
          email: '',
          interest: '',
          message: '',
          charCount: 0,
          maxChars: 1000,
          errors: {},
          success: false,
          
          validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
          },
          
          validatePhone(phone) {
            return /^[0-9\s\+\-\(\)]{8,}$/.test(phone.replace(/\s/g, ''));
          },
          
          validateForm() {
            this.errors = {};
            
            if (!this.name.trim()) {
              this.errors.name = 'Navn er påkrævet';
            }
            
            if (!this.phone.trim()) {
              this.errors.phone = 'Telefonnummer er påkrævet';
            } else if (!this.validatePhone(this.phone)) {
              this.errors.phone = 'Indtast et gyldigt telefonnummer';
            }
            
            if (!this.email.trim()) {
              this.errors.email = 'E-mail er påkrævet';
            } else if (!this.validateEmail(this.email)) {
              this.errors.email = 'Indtast en gyldig e-mail adresse';
            }
            
            if (!this.interest) {
              this.errors.interest = 'Vælg venligst et interesseområde';
            }
            
            if (!this.message.trim()) {
              this.errors.message = 'Besked er påkrævet';
            } else if (this.message.length > this.maxChars) {
              this.errors.message = 'Beskeden må maksimalt være ' + this.maxChars + ' tegn';
            }
            
            return Object.keys(this.errors).length === 0;
          },
          
          async handleSubmit(e) {
            e.preventDefault();
            
            if (!this.validateForm()) {
              return;
            }
            
            // Her kan du integrere med din mail service (f.eks. Formspree, EmailJS, eller API endpoint)
            console.log('Form data:', {
              name: this.name,
              phone: this.phone,
              email: this.email,
              interest: this.interest,
              message: this.message
            });
            
            // Simuler succesfuld indsendelse
            this.success = true;
            
            // Reset form efter 3 sekunder
            setTimeout(() => {
              this.name = '';
              this.phone = '';
              this.email = '';
              this.interest = '';
              this.message = '';
              this.charCount = 0;
              this.success = false;
            }, 3000);
          }
        }"
        @submit="handleSubmit"
        class="space-y-6"
      >
        <!-- Success Message -->
        <div
          x-show="success"
          x-transition
          class="bg-[var(--color-green--100)] border-2 border-[var(--color-green--400)] text-[var(--color-green--400)] px-6 py-4 rounded-[var(--radius-contentBox)] font-semibold"
        >
          ✓ Tak for din henvendelse! Vi vender tilbage hurtigst muligt.
        </div>

        <!-- Name Field -->
        <div>
          <label
            for="name"
            class="block text-[1.125rem] font-semibold text-[var(--color-black)] mb-2"
          >
            Navn <span class="text-[var(--color-orange--400)]">*</span>
          </label>
          <input
            type="text"
            id="name"
            x-model="name"
            class="w-full px-4 py-3 rounded-[var(--radius-contentBox)] border-2 border-[var(--color-green--200)] focus:border-[var(--color-green--400)] focus:ring-2 focus:ring-[var(--color-green--100)] outline-none transition-all duration-300 text-[1rem] bg-[var(--color-white)]"
            :class="errors.name ? 'border-[var(--color-orange--400)]' : ''"
            placeholder="Dit fulde navn"
          />
          <p
            x-show="errors.name"
            x-text="errors.name"
            class="mt-2 text-[0.875rem] text-[var(--color-orange--400)]"
          >
          </p>
        </div>

        <!-- Phone Field -->
        <div>
          <label
            for="phone"
            class="block text-[1.125rem] font-semibold text-[var(--color-black)] mb-2"
          >
            Telefonnummer <span class="text-[var(--color-orange--400)]">*</span>
          </label>
          <input
            type="tel"
            id="phone"
            x-model="phone"
            class="w-full px-4 py-3 rounded-[var(--radius-contentBox)] border-2 border-[var(--color-green--200)] focus:border-[var(--color-green--400)] focus:ring-2 focus:ring-[var(--color-green--100)] outline-none transition-all duration-300 text-[1rem] bg-[var(--color-white)]"
            :class="errors.phone ? 'border-[var(--color-orange--400)]' : ''"
            placeholder="+45 12 34 56 78"
          />
          <p
            x-show="errors.phone"
            x-text="errors.phone"
            class="mt-2 text-[0.875rem] text-[var(--color-orange--400)]"
          >
          </p>
        </div>

        <!-- Email Field -->
        <div>
          <label
            for="email"
            class="block text-[1.125rem] font-semibold text-[var(--color-black)] mb-2"
          >
            E-mail <span class="text-[var(--color-orange--400)]">*</span>
          </label>
          <input
            type="email"
            id="email"
            x-model="email"
            class="w-full px-4 py-3 rounded-[var(--radius-contentBox)] border-2 border-[var(--color-green--200)] focus:border-[var(--color-green--400)] focus:ring-2 focus:ring-[var(--color-green--100)] outline-none transition-all duration-300 text-[1rem] bg-[var(--color-white)]"
            :class="errors.email ? 'border-[var(--color-orange--400)]' : ''"
            placeholder="din@email.dk"
          />
          <p
            x-show="errors.email"
            x-text="errors.email"
            class="mt-2 text-[0.875rem] text-[var(--color-orange--400)]"
          >
          </p>
        </div>

        <!-- Interest Dropdown -->
        <div>
          <label
            for="interest"
            class="block text-[1.125rem] font-semibold text-[var(--color-black)] mb-2"
          >
            Jeg er interesseret i <span class="text-[var(--color-orange--400)]"
              >*</span
            >
          </label>
          <select
            id="interest"
            x-model="interest"
            class="w-full px-4 py-3 rounded-[var(--radius-contentBox)] border-2 border-[var(--color-green--200)] focus:border-[var(--color-green--400)] focus:ring-2 focus:ring-[var(--color-green--100)] outline-none transition-all duration-300 text-[1rem] bg-[var(--color-white)] cursor-pointer"
            :class="errors.interest ? 'border-[var(--color-orange--400)]' : ''"
          >
            <option value="">Vælg et område...</option>
            <option value="frivillig">Bliv frivillig</option>
            <option value="stoettemedlem">Bliv støttemedlem</option>
            <option value="samarbejdspartner">Bliv samarbejdspartner</option>
            <option value="erhvervspartner">Bliv erhvervspartner</option>
            <option value="spred-budskabet">Spred budskabet</option>
            <option value="andet">Andet</option>
          </select>
          <p
            x-show="errors.interest"
            x-text="errors.interest"
            class="mt-2 text-[0.875rem] text-[var(--color-orange--400)]"
          >
          </p>
        </div>

        <!-- Message Field -->
        <div>
          <label
            for="message"
            class="block text-[1.125rem] font-semibold text-[var(--color-black)] mb-2"
          >
            Din besked <span class="text-[var(--color-orange--400)]">*</span>
          </label>
          <textarea
            id="message"
            x-model="message"
            @input="charCount = message.length"
            rows="6"
            maxlength="1000"
            class="w-full px-4 py-3 rounded-[var(--radius-contentBox)] border-2 border-[var(--color-green--200)] focus:border-[var(--color-green--400)] focus:ring-2 focus:ring-[var(--color-green--100)] outline-none transition-all duration-300 text-[1rem] bg-[var(--color-white)] resize-vertical"
            :class="errors.message ? 'border-[var(--color-orange--400)]' : ''"
            placeholder="Fortæl os, hvordan vi kan hjælpe dig..."></textarea>
          <div class="flex justify-between items-center mt-2">
            <p
              x-show="errors.message"
              x-text="errors.message"
              class="text-[0.875rem] text-[var(--color-orange--400)]"
            >
            </p>
            <p
              class="text-[0.875rem] text-[var(--color-green--400)] font-medium"
              :class="charCount > maxChars ? 'text-[var(--color-orange--400)]' : ''"
            >
              <span x-text="charCount"></span>/<span x-text="maxChars"></span>
              tegn
            </p>
          </div>
        </div>

        <!-- Privacy Notice -->
        <div
          class="bg-[var(--color-green--100)] p-4 rounded-[var(--radius-contentBox)]"
        >
          <Text size="small" stylingclasses="text-[var(--color-green--400)]">
            <strong>Privatlivspolitik:</strong> Dine oplysninger behandles fortroligt
            og anvendes kun til at besvare din henvendelse. Vi deler ikke dine data
            med tredjeparter.
          </Text>
        </div>

        <!-- Submit Button -->
        <div class="flex justify-start">
          <button
            type="submit"
            class="bg-[var(--color-green--400)] text-[var(--color-green--100)] text-[1.125rem] md:text-[1.25rem] lg:text-[1.5rem] font-semibold uppercase px-8 py-4 rounded-[var(--radius-CTA)] hover:bg-[var(--color-green--100)] hover:text-[var(--color-green--400)] transition-all duration-300 inline-flex items-center gap-2"
          >
            Send besked
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
            </svg>
          </button>
        </div>

        <!-- Required Fields Note -->
        <Text size="small" stylingclasses="text-[var(--color-black)] italic">
          <span class="text-[var(--color-orange--400)]">*</span> Markerer påkrævede
          felter
        </Text>
      </form>
    </div>
  </section>
</MainLayout>
